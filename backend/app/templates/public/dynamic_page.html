{% extends "base_public.html" %}

{% block title %}{{ page.meta_title | default(page.title) }}{% endblock %}

{% block meta %}
<meta name="description" content="{{ page.meta_description | default('') }}">
{% if page.meta_keywords %}
<meta name="keywords" content="{{ page.meta_keywords }}">
{% endif %}
{% if page.canonical_url %}
<link rel="canonical" href="{{ page.canonical_url }}">
{% endif %}
{% endblock %}

{% block content %}
{# Рендеринг секций страницы из БД #}
{# ВАЖНО: Все стили через CSS классы, НЕ инлайн! #}

{% for section in page.sections %}
  {% if section.is_visible %}
    {% if section.section_type == 'hero' %}
      {% include "components/blocks/hero.html" %}
    {% elif section.section_type == 'features' %}
      {% include "components/blocks/features.html" %}
    {% elif section.section_type == 'about' %}
      {% include "components/blocks/about.html" %}
    {% elif section.section_type == 'cta' %}
      {% include "components/blocks/cta.html" %}
    {% elif section.section_type == 'pricing' %}
      {# Используем существующий шаблон pricing #}
      {% include "components/blocks/pricing.html" %}
    {% elif section.section_type == 'document_types' %}
      {# Document types grid #}
      {% include "components/blocks/document_types.html" %}
    {% elif section.section_type == 'upd_types' %}
      {# Используем существующий шаблон upd_types #}
      {% include "components/blocks/upd_types.html" %}
    {% elif section.section_type == 'faq' %}
      {% include "components/blocks/faq.html" %}
    {% elif section.section_type == 'useful_materials' %}
      {% include "components/blocks/useful_materials.html" %}
    {% elif section.section_type == 'seo_text' %}
      {% include "components/blocks/seo_text.html" %}
    {% elif section.section_type == 'form_section' %}
      {% include "components/blocks/form_section.html" %}
    {% elif section.section_type == 'articles_preview' %}
      {% include "components/blocks/articles_preview.html" %}
    {% elif section.section_type == 'articles_list' %}
      {% include "components/blocks/articles_list.html" %}
    {% else %}
      {# Custom секция - базовый рендеринг #}
      <section class="{{ section.css_classes }}">
        <div class="container">
          {% for block in section.blocks %}
            {% if block.is_visible %}
              {# Базовый рендеринг блока #}
              <div class="{{ block.css_classes }}">
                {{ block.content.text | default(block.content.title) | default('') | safe }}
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </section>
    {% endif %}
  {% endif %}
{% endfor %}

{% endblock %}
