{% extends "base_public.html" %}

{% block content %}
<!-- Article Header v12.0 -->
<section class="upd-hero-v12" style="padding-bottom: 60px;">
  <div class="upd-hero-content-v12">
    <span class="upd-hero-tag-v12">Excel бланк</span>
    <h1 class="upd-hero-title-v12">{{ page.h1 }}</h1>
    <p class="upd-hero-desc-v12">Формат: {{ page.format }}</p>
  </div>
</section>

<section class="upd-content-v12">
  <div class="upd-content-container-v12">
    <div class="upd-text-v12">
      <div style="background: white; border: 1px solid #e2e8f0; border-radius: 2rem; padding: 32px;">
        <h2 style="margin-top: 0;">Скачать бланк</h2>
        <p>Скачивание доступно после регистрации — так мы защищаем образцы и понимаем спрос.</p>

        <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 20px;">
          <button class="docu-btn-primary" id="blankDownloadBtn" type="button" style="min-width: 240px;">
            Скачать бланк
          </button>
          <a href="/dashboard/upd/create/" class="header-btn-outline-v12" style="display: inline-flex; align-items: center; justify-content: center; min-width: 220px;">
            Заполнить онлайн
          </a>
        </div>
      </div>

      <div style="margin-top: 24px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 1.5rem; padding: 24px;">
        <h3 style="margin-top: 0;">Преимущества онлайн‑генератора</h3>
        <ul>
          <li>Автозаполнение реквизитов по ИНН</li>
          <li>Автоматический расчет сумм и НДС</li>
          <li>История документов и шаблоны</li>
          <li>Экспорт в PDF и XML для ЭДО</li>
        </ul>
      </div>
    </div>

    <div class="upd-sidebar-v12">
      <div class="upd-sidebar-cta-v12">
        <h4>Хотите заполнить онлайн?</h4>
        <p>Сформируйте УПД за 2 минуты с автозаполнением по ИНН</p>
        <a href="/dashboard/upd/create/" class="docu-btn-primary" style="width: 100%; text-align: center;">Создать УПД</a>
      </div>
    </div>
  </div>
</section>

{% include "components/auth_modal.html" %}
{% endblock %}

{% block extra_js %}
<script src="/static/js/auth-download.js"></script>
<script>
// Инициализация модуля скачивания
const authDownload = new AuthDownload({
  apiType: 'blanks',
  documentType: 'upd-blank-excel',
  downloadFilename: 'upd-blank-2026.xls',
  redirectUrl: '/upd/blank-excel/?download=upd-blank-excel',
  buttonIdleText: 'Скачать бланк'
});

// Обработчик клика по кнопке
document.addEventListener('DOMContentLoaded', function() {
  const downloadBtn = document.getElementById('blankDownloadBtn');
  if (downloadBtn) {
    downloadBtn.addEventListener('click', function() {
      authDownload.checkAuthAndDownload(downloadBtn);
    });
  }

  // Автоматическое скачивание после редиректа
  authDownload.autoDownloadIfRequested();
});
</script>
{% endblock %}
