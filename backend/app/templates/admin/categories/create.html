{% extends "admin/base_admin.html" %}

{% block title %}Создать категорию{% endblock %}
{% block page_title %}Создать категорию{% endblock %}

{% block header_actions %}
<a href="/admin/categories/" class="btn btn-outline">
  <iconify-icon icon="ri:arrow-left-line" width="18"></iconify-icon>
  К списку
</a>
{% endblock %}

{% block content %}
<div class="admin-core">
  <div class="form-card form-card--standalone">
    {% if request.query_params.get('error') == 'slug' %}
    <div class="form-error">Укажите корректный slug (латиница, цифры, дефис).</div>
    {% elif request.query_params.get('error') == 'exists' %}
    <div class="form-error">Категория с таким путём уже существует.</div>
    {% endif %}

    <form method="post" action="/admin/categories/create/">
      <div class="form-group">
        <label class="label" for="parent_id">Родительская категория</label>
        <select id="parent_id" name="parent_id" class="input">
          <option value="">— Корневая —</option>
          {% for p in (parents | default([])) %}
          <option value="{{ p.id }}" {% if (parent_id | default(None)) == p.id %}selected{% endif %}>{{ p.name }} ({{ p.full_slug }})</option>
          {% endfor %}
        </select>
      </div>
      <div class="form-group">
        <label class="label" for="name">Название</label>
        <input type="text" id="name" name="name" class="input" required placeholder="Например: Налоги">
      </div>
      <div class="form-group">
        <label class="label" for="slug">Slug (сегмент URL)</label>
        <input type="text" id="slug" name="slug" class="input" required placeholder="nalogi" pattern="[a-z0-9\-]+">
        <p class="form-hint">Латиница, цифры, дефис. Итоговый путь: /news/category/{% if parent %}{{ parent.full_slug }}/{% endif %}<strong id="slug-preview">slug</strong>/</p>
      </div>
      <div class="form-group">
        <label class="label">Макет страницы категории</label>
        <div class="radio-group">
          <label class="checkbox-label"><input type="radio" name="layout" value="no_sidebar" checked> Без сайдбара</label>
          <label class="checkbox-label"><input type="radio" name="layout" value="with_sidebar"> С сайдбаром (контент 2fr + сайдбар 1fr)</label>
        </div>
      </div>
      <div class="form-group">
        <label class="label" for="meta_title">Meta title</label>
        <input type="text" id="meta_title" name="meta_title" class="input" placeholder="Опционально">
      </div>
      <div class="form-group">
        <label class="label" for="meta_description">Meta description</label>
        <textarea id="meta_description" name="meta_description" class="input" rows="2" placeholder="Опционально"></textarea>
      </div>
      <div class="form-group">
        <label class="label" for="meta_keywords">Meta keywords</label>
        <input type="text" id="meta_keywords" name="meta_keywords" class="input" placeholder="Опционально">
      </div>
      <div class="form-group">
        <label class="label" for="canonical_url">Canonical URL</label>
        <input type="text" id="canonical_url" name="canonical_url" class="input" placeholder="Опционально">
      </div>
      <div class="form-actions">
        <button type="submit" class="btn btn-primary">
          <iconify-icon icon="ri:add-line" width="18"></iconify-icon>
          Создать и перейти в редактор
        </button>
        <a href="/admin/categories/" class="btn btn-outline">Отмена</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
