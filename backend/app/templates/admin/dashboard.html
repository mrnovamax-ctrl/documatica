{% extends "admin/base_admin.html" %}

{% block title %}Статистика{% endblock %}
{% block page_title %}Статистика сервиса{% endblock %}

{% block content %}
<!-- Stats Grid -->
<div class="admin-stats-grid">
  <!-- Users -->
  <div class="admin-stat-card">
    <div class="admin-stat-icon blue">
      <iconify-icon icon="ri:user-line" width="26"></iconify-icon>
    </div>
    <div class="admin-stat-value">{{ stats.users.total }}</div>
    <div class="admin-stat-label">Пользователей</div>
    <div class="admin-stat-sub">
      <span class="highlight green">{{ stats.users.paid }}</span> платных,
      <span>{{ stats.users.verified }}</span> верифицированных,
      <span style="color: #FC3F1D; font-weight: 700;">{{ stats.users.oauth or 0 }}</span> через Яндекс
    </div>
  </div>
  
  <!-- Documents Total -->
  <div class="admin-stat-card">
    <div class="admin-stat-icon green">
      <iconify-icon icon="ri:file-text-line" width="26"></iconify-icon>
    </div>
    <div class="admin-stat-value">{{ stats.documents.total }}</div>
    <div class="admin-stat-label">Документов создано</div>
    <div class="admin-stat-sub">
      <span class="highlight blue">+{{ stats.documents.today }}</span> сегодня
    </div>
  </div>
  
  <!-- Documents Week -->
  <div class="admin-stat-card">
    <div class="admin-stat-icon gold">
      <iconify-icon icon="ri:calendar-line" width="26"></iconify-icon>
    </div>
    <div class="admin-stat-value">{{ stats.documents.week }}</div>
    <div class="admin-stat-label">За неделю</div>
    <div class="admin-stat-sub">
      {{ stats.documents.month }} за месяц
    </div>
  </div>
  
  <!-- New Users -->
  <div class="admin-stat-card">
    <div class="admin-stat-icon purple">
      <iconify-icon icon="ri:user-add-line" width="26"></iconify-icon>
    </div>
    <div class="admin-stat-value">{{ stats.users.month }}</div>
    <div class="admin-stat-label">Новых за месяц</div>
    <div class="admin-stat-sub">
      +{{ stats.users.today }} сегодня, +{{ stats.users.week }} за неделю
    </div>
  </div>
</div>

<!-- Details Section -->
<div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; margin-bottom: 40px;">
  <!-- Payments Stats -->
  <div class="admin-detail-card">
    <div class="admin-detail-header">
      <div class="admin-detail-icon admin-stat-icon green">
        <iconify-icon icon="ri:money-dollar-circle-line" width="20"></iconify-icon>
      </div>
      <div class="admin-detail-title">Платежи</div>
    </div>
    
    <div class="admin-detail-row">
      <span class="admin-detail-row-label">Всего платежей</span>
      <span class="admin-detail-row-value">{{ stats.payments.total_count }}</span>
    </div>
    
    <div class="admin-detail-row">
      <span class="admin-detail-row-label">Общая выручка</span>
      <span class="admin-detail-row-value" style="color: #10b981; font-weight: 800;">{{ stats.payments.total_revenue|int }} руб</span>
    </div>
    
    <div class="admin-detail-row">
      <span class="admin-detail-row-label">Платежей за месяц</span>
      <span class="admin-detail-row-value">{{ stats.payments.month_count }}</span>
    </div>
    
    <div class="admin-detail-row">
      <span class="admin-detail-row-label">Выручка за месяц</span>
      <span class="admin-detail-row-value" style="color: #10b981;">{{ stats.payments.month_revenue|int }} руб</span>
    </div>
  </div>
  
  <!-- Quick Info -->
  <div class="admin-detail-card">
    <div class="admin-detail-header">
      <div class="admin-detail-icon admin-stat-icon blue">
        <iconify-icon icon="ri:information-line" width="20"></iconify-icon>
      </div>
      <div class="admin-detail-title">Информация о системе</div>
    </div>
    
    <div class="admin-detail-row">
      <span class="admin-detail-row-label">Бесплатных аккаунтов</span>
      <span class="admin-detail-row-value">{{ stats.users.free }}</span>
    </div>
    
    <div class="admin-detail-row">
      <span class="admin-detail-row-label">Файлов документов на диске</span>
      <span class="admin-detail-row-value">{{ stats.files_on_disk }}</span>
    </div>
    
    <div class="admin-detail-row status-ok">
      <span class="admin-detail-row-label">Статус системы</span>
      <span class="admin-detail-row-value">
        <iconify-icon icon="ri:checkbox-circle-fill" width="18"></iconify-icon>
        Работает
      </span>
    </div>
  </div>
</div>

<!-- Quick Actions -->
<div>
  <div class="admin-actions-title">Быстрые действия</div>
  
  <div class="admin-actions-grid">
    <a href="/admin/content/" class="admin-action-btn">
      <iconify-icon icon="ri:edit-line" width="20" style="color: #3b82f6;"></iconify-icon>
      Редактировать контент
    </a>
    
    <a href="/admin/users/" class="admin-action-btn">
      <iconify-icon icon="ri:user-settings-line" width="20" style="color: #a855f7;"></iconify-icon>
      Управление пользователями
    </a>
    
    <a href="/" target="_blank" class="admin-action-btn">
      <iconify-icon icon="ri:external-link-line" width="20" style="color: #22c55e;"></iconify-icon>
      Открыть сайт
    </a>
  </div>
</div>
{% endblock %}
