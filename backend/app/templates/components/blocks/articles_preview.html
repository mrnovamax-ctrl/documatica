{# Секция «Последние статьи» — блок как на главной (featured + 2 + 2 + ссылка в архив). Контекст: latest_articles #}
{% set articles_preview = latest_articles | default([]) %}
{% if articles_preview | length > 0 %}
<section class="knowledge-hub-section pattern-light {{ section.css_classes or '' }}" id="news">
  <div class="container">
    <div class="knowledge-hub-header">
      <div class="knowledge-hub-label">
        <span class="ai-node"></span>
        <span>База знаний // Knowledge Hub</span>
      </div>
      <h2 class="knowledge-hub-title">
        Экспертиза <br><span class="accent">и протоколы</span>
      </h2>
    </div>
    <div class="knowledge-hub-grid">
      {% if articles_preview[0] %}
      <a href="/news/{{ articles_preview[0].slug }}/" class="article-card article-card--featured">
        <div class="article-card-bg-blob"></div>
        <div class="article-card-header">
          <span class="article-card-badge article-card-badge--primary">Featured Guide</span>
          <div class="article-card-arrow">
            <svg width="48" height="48" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
          </div>
        </div>
        <div class="article-card-content">
          <span class="article-card-category">{{ articles_preview[0].category | default("Статьи") }}</span>
          <h3 class="article-card-title article-card-title--large">{{ articles_preview[0].title }}</h3>
          <p class="article-card-excerpt">{{ articles_preview[0].excerpt | default(articles_preview[0].content[:150] + '...') | striptags | truncate(160) }}</p>
        </div>
      </a>
      {% endif %}
      <div class="article-card-side-grid">
        {% for article in articles_preview[1:3] %}
        <a href="/news/{{ article.slug }}/" class="article-card article-card--small">
          <div class="article-card-header">
            <span class="article-card-tag{% if loop.index == 1 %} article-card-tag--blue{% else %} article-card-tag--amber{% endif %}">{{ article.category | default("Статьи") }}</span>
            <div class="article-card-arrow article-card-arrow--small">
              <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
            </div>
          </div>
          <div class="article-card-content">
            <h4 class="article-card-title article-card-title--small">{{ article.title | truncate(50) }}</h4>
            <p class="article-card-meta">{{ article.category | default("Статьи") }}</p>
          </div>
        </a>
        {% endfor %}
      </div>
    </div>
    <div class="knowledge-hub-bottom-row">
      {% for article in articles_preview[3:5] %}
      <a href="/news/{{ article.slug }}/" class="article-card article-card--small">
        <div class="article-card-header">
          <span class="article-card-tag{% if loop.index == 2 %} article-card-tag--blue{% endif %}">{{ article.category | default("Статьи") }}</span>
          <div class="article-card-arrow article-card-arrow--small">
            <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
          </div>
        </div>
        <div class="article-card-content">
          <h4 class="article-card-title article-card-title--small">{{ article.title | truncate(45) }}</h4>
          <p class="article-card-meta">{{ article.category | default("Статьи") }}</p>
        </div>
      </a>
      {% endfor %}
      <a href="/news/" class="article-card-cta">
        <div class="article-card-cta-content">
          <h4 class="article-card-cta-title">Больше знаний</h4>
          <p class="article-card-cta-desc">Перейти в архив публикаций Documatica</p>
        </div>
        <div class="article-card-cta-icon">
          <svg width="32" height="32" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
        </div>
      </a>
    </div>
  </div>
</section>
{% endif %}
