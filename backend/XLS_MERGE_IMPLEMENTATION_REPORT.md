# –û—Ç—á–µ—Ç: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö —è—á–µ–µ–∫ –≤ XLS —ç–∫—Å–ø–æ—Ä—Ç–µ –£–ü–î

**–î–∞—Ç–∞:** 29 —è–Ω–≤–∞—Ä—è 2026  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ

---

## –ü—Ä–æ–±–ª–µ–º–∞

HTML-—ç–∫—Å–ø–æ—Ä—Ç —Å `colspan` –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª —Ä–µ–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ —è—á–µ–π–∫–∏ –≤ Excel. –ö–ª–∏–µ–Ω—Ç —Å–∫–∞—á–∏–≤–∞–ª —Ñ–∞–π–ª –∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–ª, —á—Ç–æ —è—á–µ–π–∫–∏ –Ω–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã.

## –†–µ—à–µ–Ω–∏–µ

–ü–µ—Ä–µ–ø–∏—Å–∞–Ω XLS —ç–∫—Å–ø–æ—Ä—Ç –£–ü–î —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ **xlwt** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ `.xls` —Ñ–∞–π–ª–∞ —Å –º–µ—Ç–æ–¥–æ–º `write_merge()`.

---

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### 1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ xlwt

**–§–∞–π–ª:** `backend/requirements.txt`

```python
# Excel
openpyxl==3.1.2
xlwt==1.3.0  # ‚Üê –ù–û–í–û–ï: –¥–ª—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–π –≤ .xls
```

**–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:** `pip install xlwt==1.3.0`

---

### 2. ‚úÖ –ü–µ—Ä–µ–ø–∏—Å–∞–Ω –º–µ—Ç–æ–¥ `export_to_xls()`

**–§–∞–π–ª:** `backend/app/services/excel_export.py`

**–ë—ã–ª–æ (HTML-–ø–æ–¥—Ö–æ–¥):**
```python
def export_to_xls(...):
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML —Å colspan
    html = generate_html(...)
    return StreamingResponse(html, media_type="application/vnd.ms-excel")
```

**–°—Ç–∞–ª–æ (xlwt-–ø–æ–¥—Ö–æ–¥):**
```python
def export_to_xls(...):
    # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ .xls —á–µ—Ä–µ–∑ xlwt
    buffer = self._create_xls_from_upd_data(form_data)
    return StreamingResponse(buffer, media_type="application/vnd.ms-excel")
```

---

### 3. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_create_xls_from_upd_data()`

–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –£–ü–î –≤ XLS —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **xlwt**:

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

1. **–ù–∞—Å—Ç–æ—è—â–∏–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ `write_merge()`:**
   ```python
   ws.write_merge(0, 2, 0, 3, '–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π\n–ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ã–π\n–¥–æ–∫—É–º–µ–Ω—Ç', style_header)
   ```

2. **–°—Ç–∏–ª–∏ —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏:**
   ```python
   borders = xlwt.Borders()
   borders.left = xlwt.Borders.THIN
   borders.right = xlwt.Borders.THIN
   borders.top = xlwt.Borders.THIN
   borders.bottom = xlwt.Borders.THIN
   style.borders = borders
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫:**
   ```python
   ws.col(0).width = 2500   # –ö–æ–¥ —Ç–æ–≤–∞—Ä–∞
   ws.col(1).width = 1500   # ‚Ññ
   ws.col(2).width = 8000   # –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
   # ... –∏ —Ç.–¥. –¥–ª—è 14 –∫–æ–ª–æ–Ω–æ–∫
   ```

4. **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª:**
   ```python
   style_number.num_format_str = '#,##0.00'
   ```

---

### 4. ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –£–ü–î —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏:**

#### –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (—Å—Ç—Ä–æ–∫–∏ 0-2)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ (0-2, 0-3): "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç"
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ (0, 4-13): "–°—á—ë—Ç-—Ñ–∞–∫—Ç—É—Ä–∞ ‚Ññ ... –æ—Ç ..."
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ (1, 4-13): "–°—Ç–∞—Ç—É—Å: ..."
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ (2, 4-13): "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Ññ" (–µ—Å–ª–∏ –µ—Å—Ç—å)

#### –†–µ–∫–≤–∏–∑–∏—Ç—ã –ø—Ä–æ–¥–∞–≤—Ü–∞ (—Å—Ç—Ä–æ–∫–∏ 3-5)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–ª–µ–π: –ü—Ä–æ–¥–∞–≤–µ—Ü, –ê–¥—Ä–µ—Å, –ò–ù–ù/–ö–ü–ü

#### –†–µ–∫–≤–∏–∑–∏—Ç—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (—Å—Ç—Ä–æ–∫–∏ 6-8)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–ª–µ–π: –ü–æ–∫—É–ø–∞—Ç–µ–ª—å, –ê–¥—Ä–µ—Å, –ò–ù–ù/–ö–ü–ü

#### –®–∞–ø–∫–∞ —Ç–∞–±–ª–∏—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 10-11) - –ú–ù–û–ì–û–£–†–û–í–ù–ï–í–ê–Ø
–î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏:
- –ö–æ–ª–æ–Ω–∫–∞ 0: "–ö–æ–¥ —Ç–æ–≤–∞—Ä–∞" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- –ö–æ–ª–æ–Ω–∫–∞ 1: "‚Ññ –ø/–ø" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- –ö–æ–ª–æ–Ω–∫–∞ 2: "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- **–ö–æ–ª–æ–Ω–∫–∏ 3-4: "–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è"** (–≤–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω, –Ω–∏–∂–Ω–∏–π: "–∫–æ–¥", "–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ")
- –ö–æ–ª–æ–Ω–∫–∞ 5: "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- –ö–æ–ª–æ–Ω–∫–∞ 6: "–¶–µ–Ω–∞" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- –ö–æ–ª–æ–Ω–∫–∞ 7: "–°—Ç–æ–∏–º–æ—Å—Ç—å –±–µ–∑ –ù–î–°" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- –ö–æ–ª–æ–Ω–∫–∞ 8: "–ê–∫—Ü–∏–∑" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- –ö–æ–ª–æ–Ω–∫–∞ 9: "–ù–∞–ª–æ–≥–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- –ö–æ–ª–æ–Ω–∫–∞ 10: "–°—É–º–º–∞ –ù–î–°" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- –ö–æ–ª–æ–Ω–∫–∞ 11: "–°—Ç–æ–∏–º–æ—Å—Ç—å —Å –ù–î–°" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- –ö–æ–ª–æ–Ω–∫–∞ 12: "–°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)
- –ö–æ–ª–æ–Ω–∫–∞ 13: "–ù–æ–º–µ—Ä —Ç–∞–º–æ–∂–µ–Ω–Ω–æ–π –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏" (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–æ 2 —Å—Ç—Ä–æ–∫–∏)

#### –°—Ç—Ä–æ–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 12+)
- –í—Å–µ —è—á–µ–π–∫–∏ —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
- –ß–∏—Å–ª–æ–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ü–µ–Ω –∏ —Å—É–º–º

#### –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ (row, 0-6): "–í—Å–µ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ"
- –°—É–º–º—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö

#### –ë–ª–æ–∫–∏ –ø–æ–¥–ø–∏—Å–µ–π
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–ª–µ–π: –î–æ–ª–∂–Ω–æ—Å—Ç—å, –§–ò–û, –ü–æ–¥–ø–∏—Å—å
- –ü—Ä–æ–¥–∞–≤–µ—Ü (—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å, –±—É—Ö–≥–∞–ª—Ç–µ—Ä, –ò–ü)
- –ü–æ–∫—É–ø–∞—Ç–µ–ª—å

---

### 5. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

**–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:** `backend/test_xls_merge.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ XLS —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!
üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 9728 –±–∞–π—Ç (9.50 KB)
üíæ –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω: test_upd_xlwt_output.xls
```

**–°–∫—Ä–∏–ø—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏:** `backend/verify_xls_merges.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üîó –û–ë–™–ï–î–ò–ù–ï–ù–ù–´–ï –Ø–ß–ï–ô–ö–ò: 36

‚úÖ –ü–†–û–í–ï–†–ö–ê –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –û–ë–™–ï–î–ò–ù–ï–ù–ò–ô:
  ‚úÖ –ó–∞–≥–æ–ª–æ–≤–æ–∫ '–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç' - –æ–±—ä–µ–¥–∏–Ω–µ–Ω
  ‚úÖ –ù–æ–º–µ—Ä –∏ –¥–∞—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ - –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã
  ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ '–í—Å–µ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ' - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∞

‚úÖ –£–°–ü–ï–•! –ù–∞–π–¥–µ–Ω–æ 36 –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö —è—á–µ–µ–∫
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ xlwt

### –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —è—á–µ–µ–∫
```python
ws.write_merge(row_start, row_end, col_start, col_end, text, style)
# –ü—Ä–∏–º–µ—Ä: –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 0-2, –∫–æ–ª–æ–Ω–∫–∏ 0-3
ws.write_merge(0, 2, 0, 3, '–¢–µ–∫—Å—Ç', style)
```

### –°—Ç–∏–ª–∏
```python
# –®—Ä–∏—Ñ—Ç
font = xlwt.Font()
font.name = 'Arial'
font.bold = True
font.height = 220  # 11pt (height in 1/20 pt)

# –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ
alignment = xlwt.Alignment()
alignment.horz = xlwt.Alignment.HORZ_CENTER
alignment.vert = xlwt.Alignment.VERT_CENTER
alignment.wrap = 1  # –ü–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞

# –ì—Ä–∞–Ω–∏—Ü—ã
borders = xlwt.Borders()
borders.left = xlwt.Borders.THIN
borders.right = xlwt.Borders.THIN
borders.top = xlwt.Borders.THIN
borders.bottom = xlwt.Borders.THIN

# –ó–∞–ª–∏–≤–∫–∞
pattern = xlwt.Pattern()
pattern.pattern = xlwt.Pattern.SOLID_PATTERN
pattern.pattern_fore_colour = 22  # –°–µ—Ä—ã–π
```

### –®–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
```python
ws.col(0).width = 3000  # –®–∏—Ä–∏–Ω–∞ –≤ 1/256 —á–∞—Å—Ç–∏ —Å–∏–º–≤–æ–ª–∞
```

### –§–æ—Ä–º–∞—Ç—ã —á–∏—Å–µ–ª
```python
style.num_format_str = '#,##0.00'  # –§–æ—Ä–º–∞—Ç —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ —Ç—ã—Å—è—á
```

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### ‚úÖ –î–æ (HTML-–ø–æ–¥—Ö–æ–¥):
- ‚ùå –ü—Å–µ–≤–¥–æ-–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ `colspan`
- ‚ùå Excel –Ω–µ –≤–∏–¥–∏—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚ùå –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ñ–∞–π–ª–æ–º —è—á–µ–π–∫–∏ –Ω–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã
- ‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### ‚úÖ –ü–æ—Å–ª–µ (xlwt-–ø–æ–¥—Ö–æ–¥):
- ‚úÖ –ù–∞—Å—Ç–æ—è—â–∏–π –±–∏–Ω–∞—Ä–Ω—ã–π `.xls` —Ñ–æ—Ä–º–∞—Ç
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ —è—á–µ–π–∫–∏ —á–µ—Ä–µ–∑ `write_merge()`
- ‚úÖ Excel —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –≤—Å–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
- ‚úÖ –¢–æ—á–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–≥—Ä–∞–Ω–∏—Ü—ã, —à—Ä–∏—Ñ—Ç—ã, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ)
- ‚úÖ –ß–∏—Å–ª–æ–≤—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫

---

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–ú–µ—Ç–æ–¥ `export_to_xlsx()` —á–µ—Ä–µ–∑ **openpyxl** –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∞ `.xlsx`.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ API:
- `/api/documents/{id}/export/xls` - **xlwt** (–Ω–∞—Å—Ç–æ—è—â–∏–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è)
- `/api/documents/{id}/export/xlsx` - **openpyxl** (—Ç–æ–∂–µ –Ω–∞—Å—Ç–æ—è—â–∏–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è)

---

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. ‚úÖ `backend/requirements.txt` - –¥–æ–±–∞–≤–ª–µ–Ω xlwt==1.3.0
2. ‚úÖ `backend/app/services/excel_export.py` - –ø–µ—Ä–µ–ø–∏—Å–∞–Ω export_to_xls() –∏ –¥–æ–±–∞–≤–ª–µ–Ω _create_xls_from_upd_data()

---

## –§–∞–π–ª—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. `backend/test_xls_merge.py` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ XLS —Ñ–∞–π–ª–∞
2. `backend/verify_xls_merges.py` - –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–π
3. `backend/test_upd_xlwt_output.xls` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –°–∫–∞—á–∞—Ç—å –£–ü–î —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
cd /opt/beget/documatica/backend
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å uvicorn –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω
```

### 2. –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç

```bash
cd /opt/beget/documatica/backend
python3 test_xls_merge.py
python3 verify_xls_merges.py
```

### 3. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –≤ Excel

- –û—Ç–∫—Ä–æ–π—Ç–µ `test_upd_xlwt_output.xls` –≤ Microsoft Excel
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è:
  - –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (A1:D3)
  - –ù–æ–º–µ—Ä –∏ –¥–∞—Ç–∞ (E1:N1)
  - –†–µ–∫–≤–∏–∑–∏—Ç—ã (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä–æ–∫–∞—Ö)
  - –®–∞–ø–∫–∞ —Ç–∞–±–ª–∏—Ü—ã (–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è)
  - –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ (A:G)
  - –ë–ª–æ–∫–∏ –ø–æ–¥–ø–∏—Å–µ–π

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö —è—á–µ–µ–∫:** 36
- **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:** ~9.5 KB (–¥–ª—è 2 —Ç–æ–≤–∞—Ä–æ–≤)
- **–ö–æ–ª–æ–Ω–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ:** 14
- **–°—Ç—Ä–æ–∫ (—Å –¥–∞–Ω–Ω—ã–º–∏):** ~19 (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

‚úÖ **XLS —ç–∫—Å–ø–æ—Ä—Ç –£–ü–î —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ xlwt**

‚úÖ **–í—Å–µ —è—á–µ–π–∫–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –Ω–∞—Å—Ç–æ—è—â–∏–º –æ–±—Ä–∞–∑–æ–º —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `write_merge()`**

‚úÖ **–ö–ª–∏–µ–Ω—Ç —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∏—Ç —Ñ–∞–π–ª —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–º–∏ —è—á–µ–π–∫–∞–º–∏ –≤ Excel**

‚úÖ **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞ –Ω–∞–ª–∏—á–∏–µ 36 –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö —è—á–µ–µ–∫**

---

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ
