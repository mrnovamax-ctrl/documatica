# üìä –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –£–ü–î –≤ Excel

**–î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** 29 —è–Ω–≤–∞—Ä—è 2026  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** –≠–∫—Å–ø–æ—Ä—Ç –£–ü–î –≤ —Ñ–æ—Ä–º–∞—Ç—ã XLS –∏ XLSX

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –∏–º–ø–æ—Ä—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –í–µ—Ä—Å–∏—è |
|-----------|--------|--------|
| openpyxl | ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω | 3.1.5 |
| Jinja2 | ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω | 3.1.3 |
| FastAPI | ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω | 0.109.2 |
| ExcelExportService | ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è | - |

**–í—ã–≤–æ–¥:** –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

---

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

- ‚úÖ –ù–∞–π–¥–µ–Ω–æ **55 –£–ü–î –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç: `42f4cbc3-1ab4-4586-80e1-73704feb4996`
  - –ù–æ–º–µ—Ä: 1-28012026
  - –î–∞—Ç–∞: 28.01.2026
  - –ü—Ä–æ–¥–∞–≤–µ—Ü: –ò–ü –ù–æ–≤–æ—Å–µ–ª–æ–≤ –ú–∞–∫—Å–∏–º –°–µ—Ä–≥–µ–µ–≤–∏—á
  - –ü–æ–∫—É–ø–∞—Ç–µ–ª—å: –û–û–û "–î–ù–¢"
  - –¢–æ–≤–∞—Ä–æ–≤: 4 –ø–æ–∑–∏—Ü–∏–∏
  - –°—É–º–º–∞: 23 111 —Ä—É–±.

**–í—ã–≤–æ–¥:** –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã.

---

### 3. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 3.1 –≠–∫—Å–ø–æ—Ä—Ç –≤ XLS —Ñ–æ—Ä–º–∞—Ç

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –°—Ç–∞—Ç—É—Å | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ | 796 661 –±–∞–π—Ç |
| Media Type | application/vnd.ms-excel |
| –§–æ—Ä–º–∞—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ | HTML —Å Office XML —Ç–µ–≥–∞–º–∏ |
| –ò–º—è —Ñ–∞–π–ª–∞ | UPD_1-28012026_20260128.xls |

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ:**
- ‚úÖ –°–æ–¥–µ—Ä–∂–∏—Ç HTML —Ç–∞–±–ª–∏—Ü—ã
- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ Excel –∫–∞–∫ —Ç–∞–±–ª–∏—Ü–∞
- ‚úÖ Content-Disposition –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π

#### 3.2 –≠–∫—Å–ø–æ—Ä—Ç –≤ XLSX —Ñ–æ—Ä–º–∞—Ç

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –°—Ç–∞—Ç—É—Å | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ | 6 510 –±–∞–π—Ç |
| Media Type | application/vnd.openxmlformats-officedocument.spreadsheetml.sheet |
| Magic bytes | PK\x03\x04 (–≤–∞–ª–∏–¥–Ω—ã–π ZIP) |
| –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ openpyxl | ‚úÖ –î–∞ |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏—Å—Ç–æ–≤ | 1 |
| –ù–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ | –£–ü–î |
| –†–∞–∑–º–µ—Ä | 17 —Å—Ç—Ä–æ–∫ √ó 14 –∫–æ–ª–æ–Ω–æ–∫ |

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞:**

‚úÖ **–ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞** (—Å—Ç—Ä–æ–∫–∏ 1-3):
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
- –°—á—ë—Ç-—Ñ–∞–∫—Ç—É—Ä–∞ ‚Ññ 1-28012026 –æ—Ç 28.01.2026
- –°—Ç–∞—Ç—É—Å: 2 ‚Äî –∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ

‚úÖ **–†–µ–∫–≤–∏–∑–∏—Ç—ã** (—Å—Ç—Ä–æ–∫–∏ 4-8):
- –ü—Ä–æ–¥–∞–≤–µ—Ü: –ò–ù–ù, –ö–ü–ü, –∞–¥—Ä–µ—Å
- –ü–æ–∫—É–ø–∞—Ç–µ–ª—å: –ò–ù–ù, –ö–ü–ü, –∞–¥—Ä–µ—Å

‚úÖ **–¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤** (—Å—Ç—Ä–æ–∫–∏ 10-14):
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å 14 –∫–æ–ª–æ–Ω–∫–∞–º–∏
- 4 —Ç–æ–≤–∞—Ä–∞ —Å–æ –≤—Å–µ–º–∏ —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º–∏
- –í—Å–µ –ø–æ–∑–∏—Ü–∏–∏ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

‚úÖ **–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞** (—Å—Ç—Ä–æ–∫–∞ 15):
- –í—Å–µ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ
- –ë–µ–∑ –ù–î–°: 23 111
- –ù–î–°: 0
- –° –ù–î–°: 23 111

‚úÖ **–ü–æ–¥–ø–∏—Å–∏** (—Å—Ç—Ä–æ–∫–∏ 17-19):
- –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (–ø—Ä–æ–¥–∞–≤–µ—Ü)
- –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (–ø–æ–∫—É–ø–∞—Ç–µ–ª—å)

---

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### 4.1 –®—Ä–∏—Ñ—Ç—ã

| –≠–ª–µ–º–µ–Ω—Ç | –®—Ä–∏—Ñ—Ç | –†–∞–∑–º–µ—Ä | Bold |
|---------|-------|--------|------|
| –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ | Arial | 11pt | ‚úÖ –î–∞ |
| –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã | Arial | 8pt | ‚úÖ –î–∞ |
| –î–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã | Arial | 10pt | –ù–µ—Ç |
| –ü–æ–¥–ø–∏—Å–∏ | Arial | 10pt | –ù–µ—Ç |

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ —à—Ä–∏—Ñ—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ)

#### 4.2 –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª

| –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ—Ä |
|------------|--------|--------|
| –¶–µ–Ω–∞ | #,##0.00 | 5 000.00 |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | 0.00 | 1.00 |
| –°—É–º–º–∞ | #,##0.00 | 23 111.00 |

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –§–æ—Ä–º–∞—Ç—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

#### 4.3 –°—Ç–∏–ª–∏ –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ

| –≠–ª–µ–º–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å |
|---------|--------|
| –ì—Ä–∞–Ω–∏—Ü—ã —è—á–µ–µ–∫ | ‚úÖ –¢–æ–Ω–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã –Ω–∞ –≤—Å–µ—Ö —è—á–µ–π–∫–∞—Ö |
| –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ | ‚úÖ –¶–µ–Ω—Ç—Ä/–õ–µ–≤–æ/–ü—Ä–∞–≤–æ –ø–æ —Ç–∏–ø—É –¥–∞–Ω–Ω—ã—Ö |
| –ó–∞–ª–∏–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ | ‚úÖ –°–µ—Ä–∞—è (#E0E0E0) |
| –®–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫ | ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ |
| –ü–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ | ‚úÖ –í–∫–ª—é—á–µ–Ω –≥–¥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ |

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ —Å—Ç–∏–ª–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

| –°—Ü–µ–Ω–∞—Ä–∏–π | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç | –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π | –°—Ç–∞—Ç—É—Å |
|----------|---------------------|-------------|--------|
| –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç | 404 Not Found | 404 | ‚úÖ |
| –ù–µ–≤–µ—Ä–Ω—ã–π user_id | 403 Forbidden | 403 | ‚úÖ |
| –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç | 400 Bad Request | 400 | ‚úÖ |
| –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | 401 Unauthorized | 401 | ‚úÖ |

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∞

#### –í—Å–µ –ø–æ–ª—è –£–ü–î –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç:

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã:**
- ‚úÖ –ù–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ –î–∞—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- ‚úÖ –°—Ç–∞—Ç—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞

**–ü—Ä–æ–¥–∞–≤–µ—Ü:**
- ‚úÖ –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ò–ù–ù
- ‚úÖ –ö–ü–ü
- ‚úÖ –ê–¥—Ä–µ—Å

**–ü–æ–∫—É–ø–∞—Ç–µ–ª—å:**
- ‚úÖ –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ò–ù–ù
- ‚úÖ –ö–ü–ü
- ‚úÖ –ê–¥—Ä–µ—Å

**–¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤ (14 –∫–æ–ª–æ–Ω–æ–∫):**
1. ‚úÖ ‚Ññ –ø/–ø
2. ‚úÖ –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
3. ‚úÖ –ö–æ–¥ –≤–∏–¥–∞ —Ç–æ–≤–∞—Ä–∞
4. ‚úÖ –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
5. ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
6. ‚úÖ –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
7. ‚úÖ –°—Ç–æ–∏–º–æ—Å—Ç—å –±–µ–∑ –ù–î–°
8. ‚úÖ –°—É–º–º–∞ –∞–∫—Ü–∏–∑–∞
9. ‚úÖ –ù–∞–ª–æ–≥–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞
10. ‚úÖ –°—É–º–º–∞ –ù–î–°
11. ‚úÖ –°—Ç–æ–∏–º–æ—Å—Ç—å —Å –ù–î–°
12. ‚úÖ –°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è
13. ‚úÖ –ù–æ–º–µ—Ä —Ç–∞–º–æ–∂–µ–Ω–Ω–æ–π –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏
14. ‚úÖ –ü—Ä–æ—Å–ª–µ–∂–∏–≤–∞–µ–º–æ—Å—Ç—å

**–ò—Ç–æ–≥–∏:**
- ‚úÖ –í—Å–µ–≥–æ –±–µ–∑ –ù–î–°
- ‚úÖ –í—Å–µ–≥–æ –ù–î–°
- ‚úÖ –í—Å–µ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ

**–ü–æ–¥–ø–∏—Å–∏:**
- ‚úÖ –ü—Ä–æ–¥–∞–≤–µ—Ü (–¥–æ–ª–∂–Ω–æ—Å—Ç—å, –§–ò–û)
- ‚úÖ –ü–æ–∫—É–ø–∞—Ç–µ–ª—å (–¥–æ–ª–∂–Ω–æ—Å—Ç—å, –§–ò–û)

---

## üîß –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –®—Ä–∏—Ñ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ –∂–∏—Ä–Ω—ã–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –æ–±—ã—á–Ω—ã–º —à—Ä–∏—Ñ—Ç–æ–º –≤–º–µ—Å—Ç–æ –∂–∏—Ä–Ω–æ–≥–æ  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω `bold=True` –≤ —Å—Ç–∏–ª—å –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (—Å—Ç—Ä–æ–∫–∞ 412)

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –®—Ä–∏—Ñ—Ç –¥–∞–Ω–Ω—ã—Ö Calibri –≤–º–µ—Å—Ç–æ Arial
**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —à—Ä–∏—Ñ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (Calibri) –≤–º–µ—Å—Ç–æ Arial  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω —è–≤–Ω—ã–π —à—Ä–∏—Ñ—Ç `normal_font` –¥–ª—è –≤—Å–µ—Ö —è—á–µ–µ–∫ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫–∏ 423-467)

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–¥–ø–∏—Å–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –∫–∞–∫ " / " –ø—Ä–∏ –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∏–º–µ–Ω–∏ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞ (—Å—Ç—Ä–æ–∫–∞ 503, 509)

---

## üìã API Endpoint

**URL:** `GET /api/v1/documents/saved/{document_id}/export-excel`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `format` (query, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): `xls` –∏–ª–∏ `xlsx`

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
- `Authorization: Bearer {token}` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```bash
# –≠–∫—Å–ø–æ—Ä—Ç –≤ XLS
curl -X GET "http://localhost:8000/api/v1/documents/saved/{document_id}/export-excel?format=xls" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  --output document.xls

# –≠–∫—Å–ø–æ—Ä—Ç –≤ XLSX
curl -X GET "http://localhost:8000/api/v1/documents/saved/{document_id}/export-excel?format=xlsx" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  --output document.xlsx
```

**–û—Ç–≤–µ—Ç—ã:**

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| 200 | –£—Å–ø–µ—à–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∞–π–ª |
| 400 | –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ |
| 401 | –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
| 403 | –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω (–Ω–µ –≤–ª–∞–¥–µ–ª–µ—Ü –¥–æ–∫—É–º–µ–Ω—Ç–∞) |
| 404 | –î–æ–∫—É–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω |
| 422 | –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ |
| 500 | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |

---

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å |
|----------|--------|
| –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ | ‚úÖ –î–∞ |
| Endpoint –æ—Ç–≤–µ—á–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∞–π–ª—ã | ‚úÖ –î–∞ |
| XLS —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ Excel | ‚úÖ –î–∞ |
| XLSX —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ Excel | ‚úÖ –î–∞ |
| –í—Å–µ –ø–æ–ª—è –£–ü–î –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ —Ñ–∞–π–ª–∞—Ö | ‚úÖ –î–∞ |
| –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è | ‚úÖ –î–∞ |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ | ‚úÖ –î–∞ |

**–û–±—â–∏–π —Å—Ç–∞—Ç—É—Å:** ‚úÖ **–í—Å–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã**

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XLS: ~100-200ms
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XLSX: ~50-150ms
- –†–∞–∑–º–µ—Ä XLS —Ñ–∞–π–ª–∞: ~800KB (HTML)
- –†–∞–∑–º–µ—Ä XLSX —Ñ–∞–π–ª–∞: ~6-10KB (–±–∏–Ω–∞—Ä–Ω—ã–π)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å XLSX —Ñ–æ—Ä–º–∞—Ç (–º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä, –±—ã—Å—Ç—Ä–µ–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è).

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production

1. ‚úÖ **–ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**
2. ‚ö†Ô∏è **–î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
3. ‚ö†Ô∏è **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç** –¥–ª—è –ê–∫—Ç–∞ –∏ –°—á–µ—Ç–∞ (—Å–µ–π—á–∞—Å –±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)
4. ‚ö†Ô∏è **–î–æ–±–∞–≤–∏—Ç—å rate limiting** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
5. ‚ö†Ô∏è **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö —ç–∫—Å–ø–æ—Ä—Ç–æ–≤ –¥–ª—è –∞—É–¥–∏—Ç–∞

---

## üìÅ –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `/tmp/test_upd.xlsx` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç unit-—Ç–µ—Å—Ç–∞
- `/tmp/direct_test.xls` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä—è–º–æ–≥–æ —Ç–µ—Å—Ç–∞ (XLS)
- `/tmp/direct_test.xlsx` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä—è–º–æ–≥–æ —Ç–µ—Å—Ç–∞ (XLSX)
- `/tmp/test_fixed.xlsx` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —ç–∫—Å–ø–æ—Ä—Ç–∞ –£–ü–î –≤ Excel –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production.**

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã:
- ‚úÖ –ò–º–ø–æ—Ä—Ç—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –±–∞–∑—ã
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XLS —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XLSX —Ñ–∞–π–ª–æ–≤
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç–∏–ª–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

–ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –∫–∞—á–µ—Å—Ç–≤–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∫–ª–∏–µ–Ω—Ç–∞.

---

**–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª:** Roo Debug Mode  
**–î–∞—Ç–∞:** 29.01.2026
